<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

    <changeSet id="Initial-tables-001" author="open-source-initial-author" >
        <createTable tableName="user_table">
            <column name="id" type="uuid">
                <constraints primaryKey="true"
                             primaryKeyName="pk_user_id"
                             nullable="false"/>
            </column>
            <column name="external_id" type="varchar(255)">
                <constraints nullable="true" unique="true" />
            </column>
            <column name="email" type="varchar(255)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="display_name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="timestamp">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="role">
            <column name="id" type="uuid">
                <constraints primaryKey="true"
                             primaryKeyName="pk_role_id"
                             nullable="false"/>
            </column>
            <column name="role_name" type="varchar(255)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
        <createTable tableName="user_role">
            <column name="id" type="uuid">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="user_id" type="uuid">
                <constraints foreignKeyName="fk_user_id"
                             references="user_table(id)"
                             nullable="false"/>
            </column>
            <column name="role_id" type="uuid">
                <constraints foreignKeyName="fk_role_id"
                             references="role(id)"
                             nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint tableName="user_role" columnNames="role_id, user_id" constraintName="Unique_Role_To_User" />
        <createTable tableName="application">
            <column name="id" type="uuid">
                <constraints primaryKey="true"
                             primaryKeyName="pk_app_id"
                             nullable="false"/>
            </column>
            <column name="app_name" type="varchar(255)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
        <createTable tableName="language">
            <column name="id" type="uuid">
                <constraints primaryKey="true"
                             primaryKeyName="pk_lang_id"
                             nullable="false"/>
            </column>
            <column name="lang_name" type="varchar(255)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="lang_standard_id" type="varchar(2)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
        <createTable tableName="user_preference">
            <column name="id" type="uuid">
                <constraints primaryKey="true"
                             primaryKeyName="pk_preference_id"
                             nullable="false"/>
            </column>
            <column name="user_id" type="uuid">
                <constraints foreignKeyName="fk_preference_user_id"
                             references="user_table(id)"
                             nullable="false"
                             unique="true"/>
            </column>
            <column name="language_preference" type="uuid">
                <constraints foreignKeyName="fk_user_language_id"
                             references="language(id)"
                             nullable="true"
                             unique="false"/>
            </column>
            <column name="communication_preference" type="varchar(255)">
                <constraints nullable="true" unique="false"/>
            </column>
        </createTable>
        <createTable tableName="application_preference">
            <column name="id" type="uuid">
                <constraints primaryKey="true"
                             primaryKeyName="pk_app_preference_id"
                             nullable="false"/>
            </column>
            <column name="user_id" type="uuid">
                <constraints foreignKeyName="fk_app_preference_user_id"
                             references="user_preference(user_id)"
                             nullable="false"
                             unique="false"/>
            </column>
            <column name="app_id" type="uuid">
                <constraints foreignKeyName="fk_app_id_to_preferences"
                             references="application(id)"
                             nullable="false"
                             unique="true"/>
            </column>
            <column name="lang_preference" type="uuid">
                <constraints foreignKeyName="fk_lang_pref_id"
                             references="language(id)"
                             nullable="true"
                             unique="false"/>
            </column>
            <column name="user_preference_id" type="uuid">
                <constraints foreignKeyName="user_to_app_preferences_id"
                             references="user_preference(id)"
                             nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="application_language">
            <column name="id" type="uuid">
                <constraints primaryKey="true"
                             primaryKeyName="pk_app_lang_id"
                             nullable="false"/>
            </column>
            <column name="app_id" type="uuid">
                <constraints foreignKeyName="fk_app_id"
                             references="application(id)"
                             nullable="false"
                             unique="false"/>
            </column>
            <column name="lang_id" type="uuid">
                <constraints foreignKeyName="fk_lang_id"
                             references="language(id)"
                             nullable="false"
                             unique="false"/>
            </column>
        </createTable>
        <sql>
            INSERT INTO role(id, role_name)
            VALUES ('6c319f99-977e-4376-8fed-530464774ab6', 'ROLE_1'),
                   ('fd71db5b-0109-4478-956b-1e2a4af28087', 'ROLE_2');
        </sql>
        <sql>
            INSERT INTO language(id, lang_name, lang_standard_id)
            VALUES ('c95afee7-2bc4-4c12-acdd-344b5432520e', 'English', 'en'),
                   ('b4449fdb-2f08-4c56-9c43-f0da407787d8', 'Spanish', 'es'),
                   ('138466c3-49a2-41c1-8565-7b76c0c50488', 'Chinese', 'zh'),
                   ('2e234da2-50c1-4027-9436-ef08e2153195', 'Russian', 'ru'),
                   ('bb168b6d-1ee8-4151-8efb-675e24c33499', 'Korean', 'ko'),
                   ('1a1eb8d5-e094-4f99-91e0-f2081d64b61b', 'Polish', 'pl'),
                   ('423ef4d7-ea6f-4cfb-8aeb-5ecaa46edf9a', 'Italian', 'it'),
                   ('fb0d9591-3644-478c-828e-7f2b009a07c7', 'French', 'fr'),
                   ('04b19dc7-e1d8-44a8-908c-2d85cb816cdd', 'Bengali', 'bn'),
                   ('ff16c20a-06cb-4ae8-8ecb-4b1d5d2aadca', 'Arabic', 'ar'),
                   ('c2fd2a1d-2966-42cd-a97e-9219754dd9c3', 'Yiddish', 'yi'),
                   ('01485d45-eb08-44bb-bec7-d82cda720b00', 'Haitian Creole', 'ht'),
                   ('f0372c8c-64c1-430b-9da3-5b39a48fdc9a', 'Urdu', 'ur');
        </sql>
        <sql>
            INSERT INTO application(id, app_name)
            VALUES ('6d67441b-3507-4d39-88fb-e165f594ef7b', 'app01'),
                   ('551e4105-0a7e-40a0-a9b6-7dc3a504d561', 'app02'),
                   ('7fbb8da5-9e1a-49d7-8ef6-cf7113f431d9', 'app03');
        </sql>
        <sql>
            INSERT INTO application_language(id, app_id, lang_id)
            VALUES  ('47bcef09-b406-4e3a-b87a-5a2d02329c98', '6d67441b-3507-4d39-88fb-e165f594ef7b', 'c95afee7-2bc4-4c12-acdd-344b5432520e'),
                    ('660bed07-8103-45bb-be52-4d08e39ab2e4', '6d67441b-3507-4d39-88fb-e165f594ef7b', 'b4449fdb-2f08-4c56-9c43-f0da407787d8'),
                    ('4f4d5826-e53e-4532-b7bf-681cb045b819', '6d67441b-3507-4d39-88fb-e165f594ef7b', '138466c3-49a2-41c1-8565-7b76c0c50488'),
                    ('8968aff4-f52a-4f63-b792-b5818ca883a0', '6d67441b-3507-4d39-88fb-e165f594ef7b', '2e234da2-50c1-4027-9436-ef08e2153195'),
                    ('3b2b0e0c-5e26-424a-b78c-a99aa0548205', '6d67441b-3507-4d39-88fb-e165f594ef7b', 'bb168b6d-1ee8-4151-8efb-675e24c33499'),
                    ('f22df2ef-1009-45cd-b93e-f9575cbe38df', '6d67441b-3507-4d39-88fb-e165f594ef7b', '1a1eb8d5-e094-4f99-91e0-f2081d64b61b'),
                    ('b0e6fc93-f4c0-4e8a-a52e-5a7198986f5f', '6d67441b-3507-4d39-88fb-e165f594ef7b', '423ef4d7-ea6f-4cfb-8aeb-5ecaa46edf9a'),
                    ('26203b9c-8fa0-473f-828d-d4210b98df4f', '6d67441b-3507-4d39-88fb-e165f594ef7b', 'fb0d9591-3644-478c-828e-7f2b009a07c7'),
                    ('d5fd6bfd-ebc9-4846-b2d9-0503d70d2635', '6d67441b-3507-4d39-88fb-e165f594ef7b', '04b19dc7-e1d8-44a8-908c-2d85cb816cdd'),
                    ('8173475a-88e7-4754-8679-56573f57b5d8', '6d67441b-3507-4d39-88fb-e165f594ef7b', 'ff16c20a-06cb-4ae8-8ecb-4b1d5d2aadca'),
                    ('343d87ad-e98d-4915-af2f-aecb4c4c5b95', '6d67441b-3507-4d39-88fb-e165f594ef7b', 'c2fd2a1d-2966-42cd-a97e-9219754dd9c3'),
                    ('8e57b8c7-9d0e-4e5c-b911-b6120252ae9e', '6d67441b-3507-4d39-88fb-e165f594ef7b', '01485d45-eb08-44bb-bec7-d82cda720b00'),
                    ('17259745-8d7d-4739-880c-e570e7fa2a30', '6d67441b-3507-4d39-88fb-e165f594ef7b', 'f0372c8c-64c1-430b-9da3-5b39a48fdc9a'),

                    ('4e6ba44a-5446-4be9-a4a2-1090a9cca41a', '7fbb8da5-9e1a-49d7-8ef6-cf7113f431d9', 'c95afee7-2bc4-4c12-acdd-344b5432520e'),
                    ('e00b33e9-00c7-4670-9518-e467f58bf6b6', '7fbb8da5-9e1a-49d7-8ef6-cf7113f431d9', 'b4449fdb-2f08-4c56-9c43-f0da407787d8'),
                    ('31177f51-67f9-46ba-b193-00664e33f896', '7fbb8da5-9e1a-49d7-8ef6-cf7113f431d9', '138466c3-49a2-41c1-8565-7b76c0c50488'),
                    ('3e0c9ad2-308d-4dc0-a33d-372cea213bcf', '7fbb8da5-9e1a-49d7-8ef6-cf7113f431d9', '1a1eb8d5-e094-4f99-91e0-f2081d64b61b'),
                    ('e95b36db-1313-4890-add1-89d43ffd5af5', '7fbb8da5-9e1a-49d7-8ef6-cf7113f431d9', '423ef4d7-ea6f-4cfb-8aeb-5ecaa46edf9a'),

                    ('edcb5992-2788-4042-b125-38b145c1e830', '551e4105-0a7e-40a0-a9b6-7dc3a504d561', 'c95afee7-2bc4-4c12-acdd-344b5432520e');
        </sql>
    </changeSet>
</databaseChangeLog>
